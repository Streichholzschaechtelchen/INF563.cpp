#include "Source.hpp"

int Source::M = 65536;
int Source::M2;
int Source::M34;
int Source::M4;
int Source::precision;
int Source::mask;
int Source::Q = 256;
long* Source::S;

long* Source::p = new long[Q] {
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1688, 1, 1, 1, 1, 1,
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1,
    10402, 377, 22, 1, 1, 1, 1, 662,
    2, 3, 1, 1, 1002, 552, 936, 2,
    1, 3, 1, 1, 1, 1, 1, 1, 
    1, 3, 47, 123, 4, 2, 4, 131,
    1, 439, 81, 485, 157, 549, 25, 92,
    100, 317, 99, 1, 216, 189, 344, 296,
    120, 67, 403, 170, 199, 189, 85, 2,
    76, 113, 3, 1, 1, 1, 1, 1,
    1, 3493, 430, 1187, 1655, 6617, 452, 455,
    427, 3154, 250, 3, 2284, 1240, 3291, 2547, 
    1102, 517, 2963, 3608, 3126, 3047, 813, 1, 
    211, 150, 148, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 35, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 32, 1, 1, 1, 1, 
    4, 1, 1, 1, 1, 1, 1, 1, 
    5, 7, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 
    213, 1, 39, 1, 1, 1, 1, 24,
    172, 682, 99, 1, 1, 1,33, 5, 
    1, 1, 1, 1, 29, 1, 1, 1, 
    1, 16, 1, 19, 1, 1, 1, 1
  };

void Source::initialize() {

    S = new long[Q];
    
    for ( int i = 0 ; i < Q; ++i ) {
      p[i] = 4 * p[i];
      S[i] = 0;
      for ( int j = 0 ; j < i ; ++j) S[i] = S[i] + p[j];
    }

    M = 4 * M;
    M2 = M / 2;
    M4 = M / 4;
    M34 = M2 + M4;

    for (precision = 0 ; (1 << precision) < M; ++precision);

    mask = ( 1 << precision ) - 1;
    
}
